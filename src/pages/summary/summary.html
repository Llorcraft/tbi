<ion-header>
  <ion-toolbar>
    <ion-title>Summary - {{project.name}}</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
<table>
  <thead>
    <tr>
      <th colspan="2"></th>
      <th colspan="6" class="bg-green" style="border-bottom: 5px solid #fff;">Energy analysis</th>
      <th rowspan="2" class="bg-red">Safety</th>
      <th rowspan="2" class="bg-blue">Maintenance</th>
      <th rowspan="2" class="bg-gray">Others</th>
      <th class="bg-blue-light">Tbi</th>
      <th class="bg-green-light" colspan="4">Input</th>
      <th colspan="2" rowspan="3">Actions</th>
    </tr>
    <tr>
      <th colspan="2" style="border-right: 1px solid #444">Component / Location</th>
      <th colspan="2" style="border-top: 1px solid #444; border-right: 1px solid #444">Energy Loss<br>per year</th>
      <th colspan="4" style="border-top: 1px solid #444; border-right: 1px solid #444">Potential Savings<br>per year</th>
      <th>Insulation Advise</th>
      <th class="vertical"><div><span one-line>Insulated</span></div></th>
      <th class="vertical"><div><span one-line>Surface temp</span></div></th>
      <th class="vertical"><div><span one-line>Dimension</span></div></th>
      <th class="vertical"><div><span one-line>Items number</span></div></th>
    </tr>
  </thead>
  <tbody *ngFor="let c of components; let i=index">
    <tr>
      <td rowspan="2" double-border text-center>{{i+1}}</td>
      <td rowspan="2" double-border class="b-right">{{c.fields.location}}</td>
      
      <ng-container *ngIf="!!c.result">
        <td text-center class="bg-light-red c-red">{{c.result.headLost.power | number: '1.0-0'}}</td>
        <td class="bg-light-red c-red b-right">kWh</td>
        <td text-right class="bg-green c-gree">{{c.result.savingPotentialMin?.power | number: '1.0-0'}}</td>
        <td text-center class="bg-green c-gree"><ion-icon name="md-arrow-forward"></ion-icon></td>
        <td text-right class="bg-green c-gree">{{c.result.savingPotentialMax?.power | number: '1.0-0'}}</td>
        <td class="bg-green c-gree mesure b-right">kWh</td>
      </ng-container>
      <ng-container *ngIf="!c.result">
          <td text-center class="bg-red c-bg-red"></td>
          <td class="bg-green c-blue mesure b-right"></td>
          <td text-right class="bg-green c-gree"></td>
          <td text-center class="bg-green c-gree"></td>
          <td text-right class="bg-green c-gree"></td>
          <td class="bg-green c-gree mesure b-right"></td>
      </ng-container>

      <td rowspan="2" double-border text-center class="bg-red">
        <a href="#" (click)="open(r)" *ngFor="let r of c.reports_by_type(['safety'])">{{r.name}}</a>
      </td>
      <td rowspan="2" double-border text-center class="bg-blue">
        <a href="#" (click)="open(r)" *ngFor="let r of c.reports_by_type(['mantenance', 'condensation', 'damaged'])">{{r.name}}</a>
      </td>
      <td rowspan="2" double-border text-center class="bg-gray">
        <a href="#" (click)="open(r)" *ngFor="let r of c.reports_by_type(['generic', 'custom'])">{{r.name}}</a>
      </td>
      <td rowspan="2" double-border text-center>{{advises.get(c.result.advise)}}</td>
      <td rowspan="2" double-border text-center>{{!!c.insulated ? 'Y' : 'N'}}</td>
      <td rowspan="2" double-border text-center>{{c.fields.surface_temp}}&deg;C</td>
      <td rowspan="2" double-border text-center>
        <span *ngIf="!!c.surface">{{c.fields.surface}} m<sup>2</sup></span>
        <span>{{c.fields.main_dimension}}</span>
      </td>
      <td rowspan="2" double-border text-center>{{c.fields.number}}</td>
      <td text-center double-border rowspan="2"><ion-icon (click)="edit(c)" name="md-create"></ion-icon></td>
      <td text-center double-border rowspan="2"><ion-icon (click)="remove(c)" name="md-trash"></ion-icon></td>
    </tr>

    <tr *ngIf="!!c.result">
      <td double-border text-right class="c-red">{{c.result.headLost?.money | number: '1.0-0'}}</td>
      <td double-border class="c-red mesure b-right">€<span *ngIf="!!c.insulated">/m<sup>2</sup></span></td>
      <td double-border text-right class="c-gree">{{c.result.savingPotentialMin?.money | number: '1.0-0'}}</td>
      <td double-border text-center class="c-gree"><ion-icon name="md-arrow-forward"></ion-icon></td>
      <td double-border text-right class="c-gree">{{c.result.savingPotentialMax?.money | number: '1.0-0'}}</td>
      <td double-border class="c-gree mesure b-right">€<span *ngIf="!!c.insulated">/m<sup>2</sup></span></td>
    </tr>
    <tr *ngIf="!c.result">
        <td double-border text-right class="c-blue"></td>
        <td double-border class="c-blue mesure b-right"></td>
        <td double-border text-right class="c-gree"></td>
        <td double-border text-center class="c-gree"></td>
        <td double-border text-right class="c-gree"></td>
        <td double-border class="c-gree mesure b-right"></td>
      </tr>
  </tbody>
</table>
</ion-content>

<ion-footer>
  <ion-grid no-padding>
    <ion-row no-padding>
      <ion-col col-6 no-padding>
        <button ion-button small color="light" (click)="navCtrl.pop()">
          <ion-icon name="arrow-back"></ion-icon>&nbsp;Back
        </button>
      </ion-col>
      <ion-col col-6 text-right>
          <button tabindex="15" ion-button small color="primary" (click)="go_to_reports()">
              New component
          </button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-footer>
